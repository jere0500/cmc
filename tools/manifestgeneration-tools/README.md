# APP Manifest generation tools

## Installation
1. install dependencies
```
sudo apt install apt-rdepends jq
```
- setup *Fraunhofer-AISEC/cmc* and *Fraunhofer-AISEC/tpm-pcr-tools*

2. setup of other dependencies in *dependencies/*
- compile gotouch in *dependencies/* with:
```
go build gotouch.go
```

- for automated signing:
- copy *pki/* to the *manifestgeneration-tool/* directory

3. setup template-files
copy app.manifest.json os.manifest.json rtm.manifest.json device.description.json to template-files
rtm.manifest.json and os.manifest.json should already contain the required reference values, e.g. from *./setup-full-simple*.

## Usage
./measureAll.sh
```
   Script to measure all packages of a system installed by the apt package manager
   Script depends on apt, apt-rdepends, and jq
   creates out/ for all manifests and out-signed/ for all signed manifests in json format
   by default collects hashes, generates Manifests, generates device description in out/
   by default also signs all content in out to out-signed
      -n  turns off generating appManifests'
      -s  turns off signing all content of out to out-signed/'
	if not turned of requires setup of a simple ./pki'
      -d  turns off creating a device description'
   recalculates state of current execution by the content in out and resumes generation on restart.
   to reset the script *out/*, *out-signed/* and *deps* needs to be deleted
```


./genSpecific.sh <nameofmanifest> </path/to/measure/>
```
   used to generate additional manifests based on files in a path.
   measures all files in a specified path and puts the measurements into an appManifest based on the specified manifestname
   should be run before measureAll.sh
```

./genFixManifest.sh attestation-result.json imalog.json
```
    collects all measurements that weren't found in the reference values an generates an app Manifest (fix.manifest.json) for debugging.
    takes an attestation result from previous attestation and an ima-log generated by the parse-ima-log tool.
```
